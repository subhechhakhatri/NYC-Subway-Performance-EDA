---
title: "NYC Subway Customer Journey: Exploratory Data Analysis (2020–2024)"
author: "Subhechha Khatri"
date: "2025-12-25"
output: html_document
---

# Project Overview

This project presents an exploratory data analysis (EDA) of **MTA Subway Customer Journey metrics** from **2020 to 2024**. The objective is to understand trends in ridership, journey time performance, delays, and operational differences across **time periods (Peak vs. Off-Peak)** and **divisions (A vs. B)**.

The analysis combines **data cleaning, visualization, and statistical inference** to highlight system-wide recovery patterns post-COVID-19 and identify key drivers of subway performance.

**Tools used:** `tidyverse` (`dplyr`, `ggplot2`)

---

# Load and Prepare Data

```{r message=FALSE, warning=FALSE}
library(tidyverse)

subway_data <- read.csv("MTA_Subway_Customer_Journey-Focused_Metrics__2020-2024.csv")
```

## Data Inspection

### Dataset Structure

```{r}
str(subway_data)
```

### Missing Values

```{r}
sum(is.na(subway_data))
```

### Summary Statistics

```{r}
summary(subway_data)
```

*Initial inspection confirms a clean, well-structured dataset with performance and delay metrics suitable for trend analysis and comparison.*


## Data Cleaning and Transformation

```{r}
df <- subway_data %>%
  mutate(month = as.Date(month)) %>%
  rename(perf_score = customer.journey.time.performance)

head(df)
```
---


# Exploratory Trend Analysis

## Monthly Ridership Trends (2020–2024)

```{r}
df %>%
  group_by(month) %>%
  summarise(total_passengers = sum(num_passengers, na.rm = TRUE)) %>%
  ggplot(aes(x = month, y = total_passengers)) +
  geom_line(linewidth = 1) +
   scale_y_continuous(labels = scales::label_number(scale = 1e-6, suffix = "M")) +
  labs(
    title = "Monthly NYC Subway Ridership (2020–2024)",
    x = "Year",
    y = "Total Passengers"
  ) +
  theme_minimal()
```

**Interpretation:**
Ridership declined sharply in early 2020 due to the COVID-19 pandemic. From 2021 through 2024, the data shows a resilient, consistent upward trend, reflecting the gradual return to in-person activities across New York City.

---

## Lowest Performing Lines (2020–2024)

```{r}
df %>%
  group_by(line) %>%
  summarise(mean_performance = mean(perf_score, na.rm = TRUE)) %>%
  arrange(mean_performance) %>%
  slice(1:5) %>%
  ggplot(aes(x = reorder(line, mean_performance), y = mean_performance)) +
  geom_col() +
  labs(
    title = "Bottom 5 Subway Lines by Average Performance",
    x = "Subway Line",
    y = "Mean Performance Score"
  ) +
  theme_minimal()
```

**Interpretation:**
These lines consistently perform below the system average and may benefit from focused operational review, especially during high-demand periods.

---

# Statistical Inference

## Delay Construction and Summary Statistics

```{r}
df_analysis <- df %>%
  mutate(total_delay = additional.platform.time + additional.train.time)

# Summary by division
df_analysis %>%
  group_by(division) %>%
  summarise(
    Avg_Performance = mean(perf_score, na.rm = TRUE),
    Avg_Delay = mean(total_delay, na.rm = TRUE),
    Total_Passengers = sum(num_passengers, na.rm = TRUE)
  )
```

---

## Hypothesis Testing (T-Tests)

### A. Peak vs. Off-Peak Performance

**H0 (Null Hypothesis):** Mean performance is equal across Peak and Off-Peak periods.  
**H1 (Alternative Hypothesis):** Mean performance differs between Peak and Off-Peak periods.  


```{r}
t.test(perf_score ~ period, data = df_analysis, conf.level = 0.95)
```

**Interpretation:**
At 95% confidence, the p-value is below 0.05, so we reject the null hypothesis. 
Time of day has a statistically significant effect on subway journey performance.

---

### B. Division A vs. Division B Performance

**H0 (Null Hypothesis):** Mean performance is equal across divisions.  
**H1 (Alternative Hypothesis):** Mean performance differs between Division A and Division B.

```{r}
t.test(perf_score ~ division, data = df_analysis, conf.level = 0.95)
```

**Interpretation:**
At 95% confidence level, the p-value is below 0.05, so we reject the null hypothesis.
The results indicate a statistically significant difference between mean performance between the two divisions.

---

# Correlation and Regression Analysis

## Relationship Between Delays and Performance

### Correlation

```{r}
cor_val <- cor(df_analysis$total_delay, df_analysis$perf_score)
cor_val
```

A strong negative correlation shows that higher total delays are closely associated with lower journey performance scores.

---

### Linear Regression Model
Given the earlier finding, a regression model is used to quantify how delays relate to journey performance.

```{r}
perf_model <- lm(perf_score ~ total_delay, data = df_analysis)
summary(perf_model)
```

**Interpretation:**
The model shows that total delay is a strong predictor of journey performance. The high R-squared value indicates that delays explain a large share of the variation in performance.

The Regression Equation
$$\text{Performance Score} = 0.9467 - 0.0605 \times (\text{Total Delay})$$

---

### Visualization: Delay vs. Performance

```{r}
ggplot(df_analysis, aes(x = total_delay, y = perf_score)) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm") +
  labs(
    title = "Impact of Total Delay on Journey Performance (2020–2024)",
    subtitle = paste("Correlation:", round(cor_val, 3)),
    x = "Total Delay (Minutes)",
    y = "Performance Score"
  ) +
  theme_minimal()
```

---

# Key Takeaways

- NYC subway ridership shows a steady recovery following the 2020 pandemic decline.
- Peak-hour travel is statistically less reliable than Off-Peak travel.
- Performance differences between divisions are statistically significant.
- Total delay is the main factor linked to lower journey performance.


