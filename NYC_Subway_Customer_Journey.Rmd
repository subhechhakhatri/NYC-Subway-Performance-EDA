---
title: "NYC Subway Customer Journey: Exploratory Data Analysis (2020–2024)"
author: "Subhechha Khatri"
date: "2025-12-25"
output: github_document
---

# Project Overview

This project presents an exploratory data analysis (EDA) of **MTA Subway Customer Journey metrics** from **2020 to 2024**. The objective is to understand trends in ridership, journey time performance, delays, and operational differences across **time periods (Peak vs. Off-Peak)** and **divisions (A vs. B)**.

The analysis combines **data cleaning, visualization, and statistical inference** to highlight system-wide recovery patterns post-COVID-19 and identify key drivers of subway performance.

**Tools used:** `tidyverse` (`dplyr`, `ggplot2`)

---

# Load and Prepare Data

```{r message=FALSE, warning=FALSE}
library(tidyverse)

subway_data <- read.csv("MTA_Subway_Customer_Journey-Focused_Metrics__2020-2024.csv")
```

## Data Inspection

### Dataset Structure

```{r}
str(subway_data)
```

### Missing Values

```{r}
sum(is.na(subway_data))
```

*Initial inspection confirms a clean, well-structured dataset with performance and delay metrics suitable for trend analysis and comparison.*


## Data Cleaning and Transformation

```{r}
df <- subway_data %>%
  mutate(month = as.Date(month), total_delay = additional.platform.time + additional.train.time) %>%
  rename(perf_score = customer.journey.time.performance)

head(df)
```
---


# Exploratory Trend Analysis

## Monthly Ridership Trends (2020–2024)

```{r}
df %>%
  group_by(month) %>%
  summarise(total_passengers = sum(num_passengers, na.rm = TRUE)) %>%
  ggplot(aes(x = month, y = total_passengers)) +
  geom_line(linewidth = 1) +
   scale_y_continuous(labels = scales::label_number(scale = 1e-6, suffix = "M")) +
  labs(
    title = "Monthly NYC Subway Ridership (2020–2024)",
    x = "Year",
    y = "Total Passengers"
  ) +
  theme_minimal()
```

**Interpretation:**
The system has demonstrated resilient recovery from the 2020 pandemic decline, with ridership steadily climbing from 2021-2024.

---

## Lowest Performing Lines (2020–2024)

```{r}
df %>%
  group_by(line) %>%
  summarise(mean_performance = mean(perf_score, na.rm = TRUE)) %>%
  arrange(mean_performance) %>%
  slice(1:5) %>%
  ggplot(aes(x = reorder(line, mean_performance), y = mean_performance)) +
  geom_col() +
  labs(
    title = "Bottom 5 Subway Lines by Average Performance",
    x = "Subway Line",
    y = "Mean Performance Score"
  ) +
  theme_minimal()
```

**Interpretation:**
B,D,Q,M,R lines consistently perform below the system average and may require focused improvement.

---

# Statistical Inference 

## Hypothesis Testing (T-Tests)

### A. Peak vs. Off-Peak Performance

**H0 (Null Hypothesis):** Mean performance is equal across Peak and Off-Peak periods.  
**H1 (Alternative Hypothesis):** Mean performance differs between Peak and Off-Peak periods.  


```{r}
t.test(perf_score ~ period, data = df, conf.level = 0.95)
```

**Interpretation:**
At 95% confidence, the p-value is below 0.05, so we reject the null hypothesis. 
Time of day has a statistically significant effect on subway journey performance.

---

### B. Division A vs. Division B Performance

**H0 (Null Hypothesis):** Mean performance is equal across divisions.  
**H1 (Alternative Hypothesis):** Mean performance differs between Division A and Division B.

```{r}
t.test(perf_score ~ division, data = df, conf.level = 0.95)
```

**Interpretation:**
At 95% confidence level, the p-value is below 0.05, so we reject the null hypothesis.
The results indicate a statistically significant difference between mean performance between the two divisions.


## Delay Summary by division

```{r}

df %>%
  group_by(division) %>%
  summarise(
    Avg_Performance = mean(perf_score, na.rm = TRUE),
    Avg_Delay = mean(total_delay, na.rm = TRUE),
    Total_Passengers = sum(num_passengers, na.rm = TRUE)
  )
```
**Interpretation:**
Division A consistently outperforms Division B by 5.3 percentage points (89.0% vs. 83.7%, p < 0.05), suggesting systemic operational differences requiring further investigation.


---

# Correlation and Regression Analysis

## Relationship Between Delays and Performance

### Correlation

```{r}
cor_val <- cor(df$total_delay, df$perf_score)
cor_val
```

A strong negative correlation shows that higher total delays are closely associated with lower journey performance scores.

---

### Linear Regression Model
Given the earlier finding, a regression model is used to quantify how delays relate to journey performance.

```{r}
perf_model <- lm(perf_score ~ total_delay, data = df)
summary(perf_model)
```

The Regression Equation
$$\text{Performance Score} = 0.9467 - 0.0605 \times (\text{Total Delay})$$

---

### Visualization: Delay vs. Performance

```{r}
ggplot(df, aes(x = total_delay, y = perf_score)) +
  geom_point(alpha = 0.2) +
  geom_smooth(method = "lm") +
  labs(
    title = "Impact of Total Delay on Journey Performance (2020–2024)",
    subtitle = paste("Correlation:", round(cor_val, 3)),
    x = "Total Delay (Minutes)",
    y = "Performance Score"
  ) +
  theme_minimal()
```
---

**Interpretation:**
Total delays show a strong negative correlation (-0.79) with journey performance. The regression model indicates each additional minute of delay reduces performance scores by 6%, explaining 62% of performance variation.

---

## Business Impact Analysis

Our regression model shows: For every 0.1 minutes (6 seconds) we reduce delay, performance improves by 0.61 percentage points (0.0605 × 0.1 = 0.00605).

Simple scenario: If we cut delays by 0.5 minutes (30 seconds) on average:

Performance would improve by approximately 3 percentage points (0.0605 × 0.5 = 0.03025)

Example: A route currently at 85% performance would improve to 88%




# Recommendations:
1.	Prioritize Division B operational review (5.3 points below Division A performance)
2.	Focus on peak-hour capacity optimization (statistically significant performance gap)
3.	Target bottom 5 performing lines for immediate intervention
4.  Delay Reduction Initiative - Reducing delays by just 0.5 minutes (30 seconds) could improve performance by 3 percentage points


